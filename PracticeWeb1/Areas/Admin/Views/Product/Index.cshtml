@model IPagedList<PracticeWeb1.Entities.Product>

@using PracticeWeb1.Areas.Admin.Models

@using PagedList;
@using PagedList.Mvc;

@{
    ViewBag.Title = "Index";
}

<h2>Products</h2>

<p>
    @Html.Partial("_SmallButtonPartial", new SmallButtonModel
{
    Action = "Create",
    Glyph = "plus",
    Type = "primary",
    Text = "Add Product"
})
</p><br />

@using (Html.BeginForm("Index", "Product", FormMethod.Get, new { @class = "searchForm"}))
{
    @Html.TextBox("Search","",new { @class="form-control", @placeholder="Search by Name..."})

    @Html.DropDownList("Categories", null,"All", htmlAttributes: new { @class = "form-control", @onchange = "onchange=this.form.submit()" })

    <input type="submit" class="btn btn-info" value="Search" />

    <button type="submit" class="btn btn-danger" onclick="this.form.Search.value=''"><span class="glyphicon glyphicon-minus"></span>&nbsp;Clear Search</button>
}
<br />

@if (Model.Count() == 0)
{
    <p>No records match your search criteria.</p>
}
<table class="table table-striped table-condensed">
    <tr>
        <th>
            Category
        </th>
        <th>
            @Html.ActionLink("Title", "Index", new
       {
           sortBy = ViewBag.NameSort,
           Search = Request["Search"],
           Categories = Request["Categories"]
       }, new {@class = "sort-link"})
            
        </th>
        <th>
            Price
        </th>
        <th>
            Image
        </th>
        <th></th>
    </tr>

@foreach (var item in Model)
{
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.category.Title)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Title)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Price)
        </td>
        <td>
            <a href="/Admin/Product/Details/@item.Id">
                <img src="~/Images/Uploads/Products/@item.Id/Thumbs/@item.ImageUrl" />
            </a>
        </td>
        <td>
            @Html.Partial("_SmallButtonPartial", new SmallButtonModel
       {
           Action = "Edit",
           Glyph = "pencil",
           Type = "warning",
           Id = item.Id,
           Text = "Edit"
       })

            @Html.Partial("_SmallButtonPartial", new SmallButtonModel
       {
           Action = "Details",
           Glyph = "list",
           Type = "primary",
           Id = item.Id,
           Text = "Details"
       })

            @Html.Partial("_SmallButtonPartial", new SmallButtonModel
       {
           Action = "Delete",
           Glyph = "trash",
           Type = "danger",
           Id = item.Id,
           Text = "Delete"
       })


        </td>
    </tr>
}

</table>

@Html.PagedListPager(Model, Page => Url.Action("Index", new {
    Page,
    Search = Request.QueryString["Search"],
    Categories = Request.QueryString["Categories"],
    sortBy = Request["sortBy"]
}))
